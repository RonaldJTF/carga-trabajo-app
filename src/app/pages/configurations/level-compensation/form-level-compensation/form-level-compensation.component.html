<form class="p-0" [formGroup]="formLevelCompensation">
  <div class="field">
    <label htmlFor="nombre" class="font-medium">Compensación laboral</label>
    <div class="surface-100 border-round">
      <div class="border-round-xl p-3">
        <div class="flex flex-wrap justify-content-between">
          <div class="flex align-items-center flex-wrap">
            <!--<span class="text-left font-medium w-full md:w-auto">Compensación laboral</span>-->
          </div>
          <div class="flex align-items-center flex-wrap">
            <button *ngIf="compensationFormControl.value" pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-danger p-button-text" pTooltip="Remover" tooltipPosition="bottom" (click)="removeCompensation()"></button>
            <button *ngIf="compensationFormControl.value" pButton pRipple type="button" icon="pi pi-pencil" class="p-button-rounded p-button-secondary p-button-text" pTooltip="Editar" tooltipPosition="bottom" (click)="editCompensation(compensationFormControl.value)"></button>
            <button pButton pRipple type="button" icon="pi pi-plus" class="p-button-rounded p-button-success p-button-text" pTooltip="Crear" tooltipPosition="bottom" (click)="createCompensation()"></button>
            <button *ngIf="compensationOptions.length" pButton pRipple type="button" icon="pi pi-angle-down" class="p-button-rounded p-button-info p-button-text" label="Compensación" (click)="compensationOptionsOverlayPanel.toggle($event)"></button>
          </div>
        </div>
        <div *ngIf="compensationFormControl.value" class="flex align-items-center w-full">
          <div class="flex align-items-center ">
            <div class="flex flex-column">
              <span class="text-500">{{ compensationFormControl.value.nombre | uppercase }}</span>
              <span class="text-500">{{ compensationFormControl.value.descripcion | capitalizeFirstLetter }}</span>
              <span class="text-blue-500 text-sm">{{ compensationFormControl.value.categoria.nombre | capitalizeFirstLetter }}</span>
            </div>
          </div>
        </div>
        <app-go-to-if-not-found *ngIf="!compensationFormControl.value" [showButton]="false" [message]="MESSAGE.NO_REGISTRO_CATEGORIAS" [imageSize]="IMAGE_SIZE.LARGE"></app-go-to-if-not-found>
        <div *ngIf="invalidField('compensacion') && controls('compensacion')">
          <small class="p-error">Seleccione una compensación laboral</small>
        </div>
      </div>
    </div>
  </div>

  <div class="grid">
    <div class="field p-fluid col-12 sm:col-6 m-0">
      <label htmlFor="idEscalaSalarial"><span class="font-medium">Escala salarial</span><span> (opcional)</span></label>
      <p-dropdown id="idEscalaSalarial" inputId="idEscalaSalarial" [autoDisplayFirst]="false"
                  [options]="salaryScales" optionValue="id" optionLabel="nombre" [filter]="true"
                  [showClear]="true" formControlName="idEscalaSalarial" [placeholder]="MESSAGE.SELECCIONA_OPCION"
                  [emptyMessage]="MESSAGE.NO_REGISTROS" [emptyFilterMessage]="MESSAGE.NO_REGISTROS"></p-dropdown>
    </div>
    <div class="field p-fluid col-12 sm:col-6 m-0 sm:pt-3 pt-0">
      <label htmlFor="idRegla" class="font-medium">Regla</label>
      <p-dropdown id="idRegla" inputId="idRegla" [autoDisplayFirst]="false"
                  [options]="rules" optionValue="id" optionLabel="nombre" [filter]="true"
                  [showClear]="true" formControlName="idRegla" [placeholder]="MESSAGE.SELECCIONA_OPCION"
                  [emptyMessage]="MESSAGE.NO_REGISTROS" [emptyFilterMessage]="MESSAGE.NO_REGISTROS"></p-dropdown>
    </div>
  </div>

  <div class="field p-fluid">
    <label htmlFor="idVariable" class="font-medium">Variable</label>
    <p-dropdown id="idVariable" inputId="idVariable" [autoDisplayFirst]="false"
                [options]="variables" optionValue="id" optionLabel="nombre" [filter]="true"
                [showClear]="true" formControlName="idVariable" [placeholder]="MESSAGE.SELECCIONA_OPCION"
                [emptyMessage]="MESSAGE.NO_REGISTROS" [emptyFilterMessage]="MESSAGE.NO_REGISTROS"></p-dropdown>
  </div>

  <app-form-action-button [deleting]="deleting"
                          [updateMode]="updateMode"
                          [showDeleteButton]="updateMode"
                          [creatingOrUpdating]="creatingOrUpdating"
                          (cancel)="onCancelLevelCompensation($event)"
                          (delete)="onDeleteLevelCompensation($event)"
                          (createOrUpdate)="onSubmitLevelCompensation($event)"
                          [disabledCreateOrUpdateButton]="formLevelCompensation.invalid">
  </app-form-action-button>

</form>

<p-overlayPanel #compensationOptionsOverlayPanel [showCloseIcon]="true">
  <ng-template pTemplate>
    <p-listbox [options]="compensationOptions" [group]="true" optionLabel="label" [filter]="true" title="Categorías" [emptyMessage]="MESSAGE.NO_REGISTROS" [emptyFilterMessage]="MESSAGE.NO_REGISTROS" [style]="{'max-height':'250px', 'overflow':'auto'}" (onClick)="addCompensation($event.value.value)">
      <ng-template let-group pTemplate="group">
        <div class="flex align-items-center gap-2">
          <div>{{ group.label }}</div>
          <!--<button (click)="deleteCompensation(item, $event)" pButton pRipple type="button" icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text z-5 ml-auto" pTooltip="Eliminar" tooltipPosition="bottom"></button>-->
        </div>
      </ng-template>
      <ng-template let-item pTemplate="item">
        <div class="flex align-items-center gap-2">
          <div>{{ item.label }}</div>
          <button (click)="deleteCompensation(item, $event)" pButton pRipple type="button" icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text z-5 ml-auto" pTooltip="Eliminar" tooltipPosition="bottom"></button>
        </div>
      </ng-template>
    </p-listbox>
  </ng-template>
</p-overlayPanel>
